# Data Model for "RAG Chatbot for Docusaurus Book"

This document defines the key data entities for the feature.

## Entity: DocusaurusBookContent

-   **Description**: Represents the collection of Markdown files forming the Docusaurus book.
-   **Fields**:
    -   `file_path` (string): Absolute path to the Markdown file.
    -   `content` (string): Raw content of the Markdown file.

## Entity: Chunk

-   **Description**: A small, processable segment of text extracted from `DocusaurusBookContent`.
-   **Fields**:
    -   `id` (string): Unique identifier for the chunk.
    -   `text` (string): The text content of the chunk.
    -   `metadata` (JSON): Contains `heading`, `page`, `index` (within the page/file), `file_path`.
    -   `embedding` (vector): Vector representation of the `text`.
-   **Properties**: 150-400 words with small overlap.
-   **Relationships**: Multiple `Chunks` are derived from `DocusaurusBookContent`.

## Entity: Embedding

-   **Description**: A numerical vector representing the semantic meaning of a `Chunk` or a user query.
-   **Fields**:
    -   `vector` (list of floats): The actual embedding vector.
    -   `model_id` (string): Identifier for the embedding model used (e.g., "text-embedding-004").

## Entity: QdrantCollection (Logical)

-   **Description**: Represents the collection in Qdrant storing `Chunks` with their `Embeddings` and `Metadata`.
-   **Fields**: Implicitly stores `Chunk.id`, `Chunk.embedding`, `Chunk.metadata`.

## Entity: NeonPostgresRecord (Logical)

-   **Description**: Represents records in Neon Postgres storing information about the book content and chunks.
-   **Fields**:
    -   `chunk_id` (string): Foreign key to `Chunk`.
    -   `file_path` (string): Link back to source file.
    -   `original_text_segment` (string): Possibly a larger context or raw chunk text.
    -   `indexing_timestamp` (datetime): When the chunk was last indexed.
    -   Other relevant book/chunk metadata not stored in Qdrant (e.g., full chapter titles, module structure).

## Entity: UserQuery

-   **Description**: A natural language question from the user.
-   **Fields**:
    -   `text` (string): The user's question.
    -   `embedding` (vector): Embedding of the user's question.
    -   `context_type` (enum: "full_book", "selected_text"): Indicates if the query is for the entire book or a selected passage.
    -   `selected_text` (string, optional): The text selected by the user, if `context_type` is "selected_text".

## Entity: ChatbotResponse

-   **Description**: The answer generated by the chatbot.
-   **Fields**:
    -   `answer` (string): The generated natural language answer.
    -   `source_chunks` (list of Chunk): The `Chunks` used to generate the `answer`.
    -   `response_time` (float): Time taken to generate the response.
